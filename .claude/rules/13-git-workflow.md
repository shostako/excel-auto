# Git/Makefileワークフロー

## 基本方針

- **GitHub Actions使用停止**: Excelマクロ開発には複雑すぎるため
- **直接開発重視**: コード品質向上を最優先
- **文字エンコーディング管理**: UTF-8 ↔ Shift-JIS変換の確実な実行
- **手動クリーンアップ**: セッション終了時にMakefileで実行

---

## マクロ開発フロー

1. **要件確認**
   - 入力元（シート名、テーブル名）
   - 出力先（シート名、テーブル名）
   - 処理内容の明確化

2. **コード生成**
   - `src/`ディレクトリに.basファイルとして保存
   - モジュール名を正しく設定

3. **必須変換**（毎回実行）
   ```bash
   bas2sjis src/マクロ名.bas
   ```
   - macrosフォルダにShift-JIS版が出力される
   - この手順を忘れるとExcelに取り込めない

4. **テスト方法**
   - ExcelのVBEでインポート
   - 実データでテスト実行

---

## Git管理手順

### 推奨コミットフロー

1. **開発**: `src/`でUTF-8ファイル編集
2. **変換**: bas2sjisで`macros/`に出力
3. **確認**: 変換結果とテスト
4. **コミット**: Git add → commit → push

### ファイル管理

- **追跡対象**: `src/`、`scripts/`、`docs/`
- **除外対象**: `macros/`（.gitignoreで除外推奨）
- **一時ファイル**: 自動削除される

---

## ワークスペース管理

### ワークスペースクリーンアップ

**実行方法**:
```bash
make clean  # または自然言語で「クリーンアップして」「クリーン」
```

**動作**:
1. `src/*.bas`、`macros/*.bas`、`inbox/*.bas`を表示
2. 削除確認プロンプト
3. 削除実行
4. Git add → commit（"clean: ワークスペースクリーンアップ - セッション終了"）

**Monday（Claude）の責務**:
- セッション終了時にクリーンアップを提案
- ユーザーの「クリーン」「片付けて」等の指示で`make clean`実行
- Makefileの存在を認識し、自然言語指示を適切に変換
