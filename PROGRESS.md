# プロジェクト進捗状況

## 現在の状態
- **最終更新**: 2026-01-21 09:36
- **アクティブタスク**: なし（全タスク完了）

## 進行中
- なし

## 完了済み（今回セッション）
- [x] UserForm5 ID範囲指定対応（22-25 → 22,23,24,25）
- [x] UserForm5 DataModifiedフラグ追加（クエリ更新判定用）
- [x] UserForm5 削除モード対応（データ無効化、実行後フォーム閉じる）
- [x] mゾーン別データ転送ADO.bas - 品番末尾・注番月フィールド削除
- [x] mクエリ西暦更新.bas - 新規作成（Power Query接続先を動的変更）
- [x] 不良集計ゾーン別ADO.pq - 年間DBのみ参照に変更
- [x] m自動採番リセットAccess.bas - DBパス動的構築対応

## 完了済み（前回セッション）
- [x] UserForm5 レイアウト微調整
- [x] UserForm5 入力制限追加（CTextBoxEventクラスハンドラ接続）
- [x] UserForm5 フォント設定（Meiryo UI, Yu Gothic UI）
- [x] UserForm5 ID欄の窪み対応
- [x] UserForm5 選択列削除
- [x] UserForm5 TabIndex設定
- [x] UserForm5 誤操作防止

## 完了済み（前回セッション）
- [x] UserForm2から品番末尾（ComboBox3）と注番月（TextBox2）を削除
- [x] CTextBoxEvent.clsからMonthタグ処理を削除
- [x] mゾーン別データ転送ADO.basから品番末尾・注番月フィールドを削除
- [x] UserForm5（データ修正・削除フォーム）新規作成
  - IDベースでAccessデータを検索・修正・削除
  - トグルボタンで修正/削除モード切替
  - 動的コントロール生成（ヘッダーラベルも動的）
  - 最大10件同時処理対応
  - トランザクション制御（エラー時ロールバック）

## 完了済み（過去）
- [x] VBAマクロ開発基盤（src/macros分離、bas2sjis変換スクリプト）
- [x] PermissionRequestフック削除（MCPツール不使用のため簡素化）
- [x] Plan Mode運用ルール策定（CLAUDE.mdに追記）
- [x] コメント標準化（入力開始セル選択、番号転送ADO、ロット数量調査など）
- [x] Makefile整備（clean自動モード対応）
- [x] 空欄項目の不良数集計バグ修正（G系列2ファイル + H系列3ファイル）
- [x] G系列タイトル表記変更（流出G_成形_期間1_... → 成形_流出手直し（廃棄込）...）
- [x] フィルターマクロ排他的方式実装（完成品/側板/小部品は排他、項目は独立）
- [x] 側板フィルター・項目フィルター新規追加
- [x] テーブル名パターン検索対応（シートコピー時の「_完成品2」等に対応）
- [x] 日付表示マクロ新規追加（A3の日付を画面左端にスクロール）
- [x] フィルターマクロ水平スクロール維持（垂直のみスクロール）
- [x] 複合フィルター対応（完成品/側板/小部品 AND 項目フィルター）
- [x] 項目フィルターカンマ区切り対応（「実績,計画」等でOR条件）
- [x] イベントコード分配方式変更（Workbook_SheetChange → 各シートのWorksheet_Change）
- [x] 項目フィルター「合計」「稼働日」行常時表示機能追加
- [x] /wrapコマンド新規作成（セッション終了処理一括実行）
- [x] .claude/rules/ディレクトリ導入（CLAUDE.md分割管理）
- [x] 項目追加マクロ汎用化（テーブル名・項目名を引数指定）
- [x] 項目削除マクロ新規作成（テーブル名・項目名を引数指定）
- [x] フィルター解除マクロ改修（オートフィルターリセット機能追加）
- [x] wrap時クリーンアップルール明確化（inbox/macros自動クリア、src確認なしコミット）
- [x] フィルターマクロ オートフィルター方式へ全面変更（複合フィルター対応、手動オートフィルター維持）
- [x] 項目追加マクロ全テーブル対応（_core/_slitter/_acf系にも対応、列存在チェック方式）
- [x] Windows環境問題分析（Claude CodeのGit Bash依存が原因、WSL環境に戻す決定）
- [x] Windows版ナレッジのWSL版マージ（コーディング規約、参照名確認ルール等）
- [x] /vbaコマンド新規作成（VBAマクロ生成ワークフロー）

## 未完了・保留
- なし

## 次セッションへの引き継ぎ
- **UserForm5は完成**: テスト後、本番運用開始
- **転送・クエリ関連マクロ更新済み**: 品番末尾・注番月削除対応、西暦動的変更対応
- **自動採番リセット**: DBパス動的構築対応済み、コマンドボタン不要（マクロダイアログから実行）
- **重要な発見**:
  - **文字コード**: inboxファイルはShift-JIS（必ずiconvで変換してから読む）
  - **動的コントロール**: ヘッダーラベルも動的生成にすると位置ズレ問題を解消できる
  - **CTextBoxEvent接続**: 動的生成TextBoxにもクラスハンドラ配列で接続可能
- **参照すべきリソース**:
  - `src/UserForm5.frm`（修正・削除フォームのコード）
  - `src/mクエリ西暦更新.bas`（Power Query接続先変更）
  - `src/m自動採番リセットAccess.bas`（ID振り直し）

## 直近のGitコミット
- 709e948 feat: 集計表転記マクロの不良関連転記先を変更
- 47c1a2b docs: WezTerm + WSL環境設定のログ追加
