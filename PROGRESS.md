# プロジェクト進捗状況

## 現在の状態
- **最終更新**: 2025-12-11 18:17
- **アクティブタスク**: なし（継続的なマクロ開発・保守）

## 完了済み
- [x] VBAマクロ開発基盤（src/macros分離、bas2sjis変換スクリプト）
- [x] PermissionRequestフック導入（静的allow 41個→6個+フック）
- [x] Plan Mode運用ルール策定（CLAUDE.mdに追記）
- [x] コメント標準化（入力開始セル選択、番号転送ADO、ロット数量調査など）
- [x] Makefile整備（clean自動モード対応）
- [x] 空欄項目の不良数集計バグ修正（G系列2ファイル + H系列3ファイル）
- [x] G系列タイトル表記変更（流出G_成形_期間1_... → 成形_流出手直し（廃棄込）...）
- [x] フィルターマクロ排他的方式実装（完成品/側板/小部品は排他、項目は独立）
- [x] 側板フィルター・項目フィルター新規追加
- [x] テーブル名パターン検索対応（シートコピー時の「_完成品2」等に対応）
- [x] 日付表示マクロ新規追加（A3の日付を画面左端にスクロール）
- [x] フィルターマクロ水平スクロール維持（垂直のみスクロール）
- [x] 複合フィルター対応（完成品/側板/小部品 AND 項目フィルター）
- [x] 項目フィルターカンマ区切り対応（「実績,計画」等でOR条件）
- [x] イベントコード分配方式変更（Workbook_SheetChange → 各シートのWorksheet_Change）
- [x] 項目フィルター「合計」行常時表示機能追加
- [x] /wrapコマンド新規作成（セッション終了処理一括実行）
- [x] .claude/rules/ディレクトリ導入（CLAUDE.md分割管理）

## 未完了・保留
- [ ] Phase 2: 親プロジェクトに共通ルール展開（シンボリックリンク方式）

## 次セッションへの引き継ぎ
- **次のアクション**: 親プロジェクトで.claude/rules/展開（Phase 2）
- **重要な発見**:
  - **文字コード**: inboxファイルはShift-JIS（必ずiconvで変換してから読む）
  - **Plan Mode**: 調査は直接実行（iconv）、サブエージェント不要
  - **フック効果**: 頻繁な操作（iconv、git等）は確認なしで実行可能
  - **空欄処理修正パターン**: `If Len(xxx) > 0 Then`を削除して`If Len(xxx) = 0 Then xxx = "（空白）"`を追加する際、対応する`End If`も削除すること
  - **項目フィルター**: カンマ区切りで複数値指定可能（OR条件）
  - **イベントコード方式**: Workbook_SheetChangeは全シートで発火するため、異なる書式のシートがあるとエラーになる。各シートのWorksheet_Changeに分配する方式が安全
  - **セッション終了**: `/wrap`コマンドでコミット・ログ・PROGRESS更新・push・クリーンアップを一括実行
  - **.claude/rules/**: v2.0.64新機能。CLAUDE.mdを分割管理可能。番号プレフィックスで整理
- **参照すべきリソース**:
  - `.claude/rules/`（分割されたルールファイル）
  - `docs/excel-knowledge/claude-code/EXCEL_MACRO_KNOWLEDGE_BASE.md`（実戦的ナレッジ）
  - `docs/excel-knowledge/failures/001_activate_vs_screenupdating.md`（画面ちらつき問題）
  - `logs/2025-12.md`（フィルターマクロ改修の詳細）

## 直近のGitコミット
- 1aa1435 feat: .claude/rules/ディレクトリ導入・CLAUDE.md分割
- 099941e feat: /wrapコマンド新規作成・Mondayの行動ルール追加
- 1b79cc6 docs: PROGRESS.md・作業ログ更新
