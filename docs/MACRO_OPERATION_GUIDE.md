# 加工作業者別マクロ運用ガイド

## はじめに

このガイドは、加工作業者別データ処理システムの実際の運用方法を解説します。
5つのマクロを適切な順序・タイミングで実行することで、日別データから最終的な分析結果まで自動化できます。

## 運用パターン

### 📅 日次運用（毎日実行）

#### 1. データ更新時の処理
```
手順:
1. 「クエリ全工程」シートのデータが更新されていることを確認
2. マクロ実行: m日別集計_加工作業者別
3. マクロ実行: m転記_シート加工作業者別
4. 処理結果の確認
```

**実行タイミング**: データ更新後、1日1回

**所要時間**: 約2-3分（データ量により変動）

**確認ポイント**:
- [ ] 「クエリ全工程」にその日のデータが存在する
- [ ] 加工1、加工2の工程データが含まれている
- [ ] 作業者名が正しく入力されている（空白なし）

#### 2. 新規作業者が追加された場合
新規作業者のデータが含まれている場合、**m転記_シート加工作業者別** が自動的に：
- 新規作業者を検出
- 空きスロット（A-J）に自動割り当て
- 8列パターンを一括変更

**注意**: 空きスロットがない場合（10名を超える場合）は手動対応が必要

### 🗓️ 月初運用（月1回実行）

#### 月初リセット処理
```
手順:
1. マクロ実行: m復元_作業者列名
2. 日次運用を再開
```

**実行タイミング**: 毎月1日（または月初営業日）

**目的**: 
- 前月の作業者設定をクリア
- A-J形式の標準列名に復元
- 新しい月の作業者構成に対応

**重要**: この処理を忘れると、前月の作業者設定が残り続けます

### 📊 分析時運用（必要に応じて実行）

#### 実績分析・レポート作成時
```
手順:
1. 集計表シートのA1セルに分析対象日付を入力
2. マクロ実行: m転記_集計表_作業者名
3. マクロ実行: m転記_集計表_加工作業者別
4. 集計表での分析・レポート作成
```

**実行タイミング**: 
- 日次レポート作成時
- 週次・月次分析時
- 管理者への報告時

**出力結果**:
- 58行目: その日の実績上位5名の作業者名
- 59-65行目: 各作業者の詳細指標（7種類）

## 具体的な操作手順

### 日次処理の詳細手順

#### ステップ1: データ確認
1. 「クエリ全工程」シートを開く
2. 最新データが更新されていることを確認
3. 日付、工程、作業者列にデータが正しく入力されていることを確認

#### ステップ2: 日別集計実行
1. VBE（Alt+F11）を開く
2. モジュール「m日別集計_加工作業者別」を選択
3. F5キーでマクロ実行
4. ステータスバーで進捗を確認
5. 完了メッセージを確認

**実行中の表示例**:
```
ステータスバー: "加工作業者別集計を開始します..."
ステータスバー: "データを集計中..."
ステータスバー: "データをソート中..."
ステータスバー: "データを出力中..."
```

#### ステップ3: 転記処理実行
1. モジュール「m転記_シート加工作業者別」を選択
2. F5キーでマクロ実行
3. 新規作業者の自動割り当てメッセージを確認
4. 転記完了を確認

**実行中の表示例**:
```
ステータスバー: "作業者チェック中..."
ステータスバー: "新規作業者 山田 を A スロットに割り当て中..."
ステータスバー: "データ転記中..."
```

### 月初処理の詳細手順

#### 列名復元処理
1. VBE（Alt+F11）を開く
2. モジュール「m復元_作業者列名」を選択
3. F5キーでマクロ実行
4. 復元進捗を確認（80列処理）

**実行中の表示例**:
```
ステータスバー: "列名復元処理を開始します..."
ステータスバー: "列名復元中... 50% (40/80)"
ステータスバー: "列名復元が完了しました (80列復元)"
```

### 分析処理の詳細手順

#### 上位者抽出
1. 「集計表」シートを開く
2. A1セルに分析対象日付を入力（例：2024/01/15）
3. VBE（Alt+F11）を開く
4. モジュール「m転記_集計表_作業者名」を選択
5. F5キーでマクロ実行
6. D58, F58, H58, J58, L58セルに作業者名が転記されることを確認

#### 詳細指標転記
1. モジュール「m転記_集計表_加工作業者別」を選択
2. F5キーでマクロ実行
3. 59-65行目に各指標データが転記されることを確認

## トラブルシューティング

### よくあるエラーと対処法

#### 1. 「テーブルが見つかりません」エラー
**原因**: テーブル名の不一致、シート名の変更
**対処**:
- シート名が正しいか確認
- テーブル名（_クエリ全工程、_加工作業者別a、_加工作業者別b）を確認
- 手動でテーブル名を修正

#### 2. 「日付として認識できません」エラー
**原因**: 日付形式の不正、空白セル
**対処**:
- 日付列のデータ形式を確認（yyyy/mm/dd推奨）
- 空白セルがないか確認
- セルの書式を「日付」に設定

#### 3. 「列が見つかりません」エラー
**原因**: 列名の不一致、文字化け
**対処**:
- イミディエイトウィンドウ（Ctrl+G）でDebug.Print出力を確認
- 列名にスペースや特殊文字がないか確認
- 必要に応じて列名を手動修正

#### 4. 新規作業者が割り当てられない
**原因**: 空きスロット不足（10名を超えている）
**対処**:
- 月初処理（m復元_作業者列名）を実行
- 不要な作業者データを整理
- 手動で空きスロットを作成

### データ整合性チェック

#### 日次チェック項目
- [ ] _加工作業者別aテーブルに当日データが存在する
- [ ] 作業者名に空白がない
- [ ] 数値データが正常範囲内（負の値がない等）
- [ ] _加工作業者別bテーブルに転記が完了している

#### 月初チェック項目
- [ ] _加工作業者別bテーブルの列名がA-J形式になっている
- [ ] 80列すべてが復元されている
- [ ] データの整合性が保たれている

#### 分析時チェック項目
- [ ] 集計表A1セルの日付が正しい
- [ ] 58行目に5名の作業者名が表示されている
- [ ] 59-65行目に数値データが転記されている
- [ ] 空白セルに0が入力されている

## パフォーマンス最適化

### 推奨実行環境
- **Excel**: 2016以降
- **メモリ**: 8GB以上
- **データ量**: 1日あたり1000行程度まで

### 処理速度向上のコツ
1. **他のExcelファイルを閉じる**: メモリ使用量を削減
2. **不要なアドインを無効化**: 処理速度向上
3. **定期的なデータ整理**: 古いデータのアーカイブ
4. **ファイルサイズの管理**: 定期的な最適化実行

## 運用スケジュール例

### 日次運用（月-金）
```
9:00  - データ更新確認
9:30  - 日別集計実行（m日別集計_加工作業者別）
9:35  - 転記処理実行（m転記_シート加工作業者別）
9:40  - データ確認・検証
17:00 - 日次レポート作成（分析処理実行）
```

### 月次運用（月初）
```
月初営業日:
8:30  - 月初処理実行（m復元_作業者列名）
9:00  - 日次運用開始
```

### 週次・月次レポート
```
週末/月末:
- 期間集計の実行
- 傾向分析の実施
- 管理資料の作成
```

## 注意事項とベストプラクティス

### セキュリティ
- **マクロセキュリティ**: 信頼できる場所に配置
- **ファイル保護**: パスワード設定推奨
- **バックアップ**: 定期的なファイルバックアップ

### データ管理
- **命名規則**: 統一された作業者名使用
- **データ品質**: 入力時の検証強化
- **履歴管理**: 変更履歴の記録

### 運用体制
- **責任者設定**: マクロ実行責任者の明確化
- **引継ぎ資料**: 操作手順の文書化
- **定期点検**: 月次でのシステム動作確認

---

## 付録: チェックリスト

### 日次運用チェックリスト
- [ ] データ更新確認完了
- [ ] m日別集計_加工作業者別 実行完了
- [ ] m転記_シート加工作業者別 実行完了
- [ ] エラーなく処理完了
- [ ] 結果データ確認完了

### 月初運用チェックリスト
- [ ] m復元_作業者列名 実行完了
- [ ] 80列の復元確認完了
- [ ] データ整合性確認完了
- [ ] 日次運用再開

### 分析時チェックリスト
- [ ] 分析対象日付入力完了
- [ ] m転記_集計表_作業者名 実行完了
- [ ] m転記_集計表_加工作業者別 実行完了
- [ ] 集計表データ確認完了
- [ ] レポート作成完了

---

*このガイドは実際の運用経験に基づいて作成されています。不明な点があれば、各マクロのコメントとエラーメッセージを参照してください。*