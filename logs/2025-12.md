# 2025年12月 作業ログ

## 2025-12-01 作業概要

### 不良数集計バグ修正（m転記_流出_成形G.bas）

**問題**：
- 58050RrLH列で不良数=20だが、項目別合計=19（1件不足）
- ユーザー調査で廃棄テーブルの不良内容列に空白セルがあることを発見

**原因特定**：
- 手直し/廃棄テーブル処理で `If Len(mode2) > 0 Then` / `If Len(furyouNaiyou) > 0 Then` の条件があった
- 不良数は無条件で加算されるが、項目別は空欄だとスキップされる
- 結果：空欄のレコードがあると不良数と項目別合計が不一致

**修正**：
- 空欄の場合は「（空白）」という項目名で集計するように変更
- 手直し処理（行422-427）と廃棄処理（行477-482）の2箇所を修正

**教訓**：
- 集計処理では「加算条件」と「分類条件」が一致しているか確認すること
- 空欄データの扱いを明示的に定義しておくことが重要
